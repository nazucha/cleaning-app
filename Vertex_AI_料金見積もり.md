# Vertex AI 料金見積もり

## 概要

Vertex AI経由のGemini APIを使用する場合の料金体系と見積もりです。

## 料金体系

### 1. Gemini APIの基本料金（トークン課金）

#### Gemini 2.0 Flash（推奨）
- **入力**: $0.10 / 100万トークン（約15円）
- **出力**: $0.40 / 100万トークン（約60円）
- **1リクエストあたり**: 約500-800トークン
- **1リクエストのコスト**: 約$0.0004-0.0006（約0.06-0.09円）

#### Gemini 2.5 Pro
- **入力**: $1.25 / 100万トークン（約187円）
- **出力**: $5.00 / 100万トークン（約750円）

#### Gemini 3 Pro Preview
- **入力**: $2.00 / 100万トークン（約300円）
- **出力**: $12.00 / 100万トークン（約1,800円）

### 2. Google Searchグラウンディング料金（重要）

**Vertex AIの方がDeveloper APIより安い！**

| 項目 | Developer API | Vertex AI |
|------|--------------|-----------|
| グラウンディング料金 | $35 / 1,000件<br>（約5,250円） | **$14 / 1,000件**<br>（**約2,100円**） |
| 無料枠 | なし | モデルにより異なる |

#### Vertex AIの無料枠（グラウンディング）
- **Gemini 2.5 Pro**: 1日10,000件まで無料
- **Gemini 2.0/2.5 Flash**: 1日1,500件まで無料
- **Gemini 3 Pro**: 月5,000件まで無料

**重要**: グラウンディング機能から提供される入力トークンは課金対象外です。

## 月間コスト見積もり

### シナリオ1: 少ない使用量（1日50件、月間1,500件）

| 項目 | 数量 | コスト |
|------|------|--------|
| Gemini API（トークン） | 1,500件 | 約$0.6-0.9（約90-135円） |
| グラウンディング（Flash） | 1,500件 | **無料**（無料枠内） |
| **合計** | - | **約90-135円/月** |

### シナリオ2: 中程度の使用量（1日200件、月間6,000件）

| 項目 | 数量 | コスト |
|------|------|--------|
| Gemini API（トークン） | 6,000件 | 約$2.4-3.6（約360-540円） |
| グラウンディング（Flash） | 6,000件 | 約$63（約9,450円）<br>（無料枠1,500件超過分4,500件） |
| **合計** | - | **約9,810-9,990円/月** |

### シナリオ3: 多い使用量（1日500件、月間15,000件）

| 項目 | 数量 | コスト |
|------|------|--------|
| Gemini API（トークン） | 15,000件 | 約$6-9（約900-1,350円） |
| グラウンディング（Flash） | 15,000件 | 約$189（約28,350円）<br>（無料枠1,500件超過分13,500件） |
| **合計** | - | **約29,250-29,700円/月** |

### シナリオ4: Gemini 2.5 Proを使用する場合（1日200件、月間6,000件）

| 項目 | 数量 | コスト |
|------|------|--------|
| Gemini API（トークン） | 6,000件 | 約$30-45（約4,500-6,750円） |
| グラウンディング（2.5 Pro） | 6,000件 | **無料**（無料枠10,000件/日内） |
| **合計** | - | **約4,500-6,750円/月** |

**推奨**: グラウンディングの無料枠を最大限活用するため、**Gemini 2.5 Pro**の使用を検討してください。

## コスト削減のポイント

### 1. ローカル判定を優先（現在実装済み）
- ローカル判定で確定できる型番はAPIを呼ばない
- **APIコール数を大幅に削減可能**
- 例: CS-Aシリーズ、SRK-RS-シリーズなどは即座に判定

### 2. 無料枠の活用
- **Gemini 2.5 Pro**: 1日10,000件までグラウンディング無料
- 1日あたりの使用量が10,000件以下なら、グラウンディング料金は**完全無料**

### 3. キャッシングの実装（将来の拡張）
- 同じ型番のリクエストをキャッシュ
- 重複リクエストを削減

### 4. ローカルデータベースの活用（現在実装済み）
- `cleaningFunctionData.json`に保存されたデータを優先使用
- グラウンディングで取得した結果も自動保存
- 2回目以降はAPIを呼ばずに即座に結果を返す

## 現在の実装での推定コスト

### ローカル判定が最優先
- **主要型番（CS-A、SRK-RS-など）**: APIを呼ばずに即座に結果を返す
- **APIコール数**: ローカル判定で確定できない型番のみ
- **推定**: 1日あたり10-100リクエスト程度

### 月間コスト見積もり（現在の使用パターン想定）

| 使用量 | Gemini API | グラウンディング | 合計 |
|--------|-----------|----------------|------|
| 1日50件（月間1,500件） | 約90-135円 | 無料（無料枠内） | **約90-135円/月** |
| 1日100件（月間3,000件） | 約180-270円 | 約$21（約3,150円） | **約3,330-3,420円/月** |
| 1日200件（月間6,000件） | 約360-540円 | 約$63（約9,450円） | **約9,810-9,990円/月** |

**Gemini 2.5 Proを使用する場合**（グラウンディング無料枠10,000件/日）:
- 1日200件まで: **約4,500-6,750円/月**（グラウンディング無料）

## 推奨設定

### コストを最小限に抑える場合
1. **Gemini 2.5 Proを使用**（グラウンディング無料枠が大きい）
2. **ローカル判定を優先**（現在実装済み）
3. **ローカルデータベースを活用**（現在実装済み）

### パフォーマンスとコストのバランス
1. **Gemini 2.0 Flashを使用**（高速・低コスト）
2. 1日あたり1,500件以下に使用量を抑える（グラウンディング無料枠内）

## まとめ

### Vertex AIのメリット
- **グラウンディング料金がDeveloper APIより60%安い**（$14 vs $35）
- **無料枠が充実**（Gemini 2.5 Pro: 1日10,000件まで無料）
- **Google Cloudの統合**（他のサービスとの連携が容易）

### 月間コスト目安
- **少ない使用量（月間1,500件）**: 約90-135円/月
- **中程度（月間6,000件）**: 約9,810-9,990円/月（Flash）または約4,500-6,750円/月（2.5 Pro）
- **多い使用量（月間15,000件）**: 約29,250-29,700円/月（Flash）

### 推奨
- **1日あたり200件以下**: Gemini 2.5 Proを使用（グラウンディング完全無料）
- **1日あたり200件超**: Gemini 2.0 Flashを使用（高速・低コスト）

現在の実装では、ローカル判定を優先するため、**実質的なAPIコール数は最小限**に抑えられています。

## 参考リンク

- [Vertex AI 料金](https://cloud.google.com/vertex-ai/generative-ai/pricing?hl=ja)
- [Gemini API 料金](https://ai.google.dev/gemini-api/docs/pricing?hl=ja)
- [グラウンディングの概要](https://cloud.google.com/vertex-ai/generative-ai/docs/grounding/overview?hl=ja)
