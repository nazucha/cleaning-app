# Developer API vs Vertex AI 比較（整合性確認用）

## 現在の状況

- **現在接続中**: Developer API（無料プラン）
- **確認対象**: 約4,115件の型番
- **最適化後**: 約800-1,200件のAPI呼び出し（推定）

## コスト比較

### Developer API（現在の接続）

| 項目 | 料金 |
|------|------|
| **グラウンディング料金** | **$35 / 1,000件**（無料枠なし） |
| **Gemini API料金** | 約$0.1-0.15 / 1,000件（ほぼ無視できる） |
| **800-1,200件のコスト** | **$28-42**（約**4,200-6,300円**） |

### Vertex AI（Gemini 2.5 Pro）

| 項目 | 料金 |
|------|------|
| **グラウンディング料金** | **無料**（1日10,000件まで無料枠） |
| **Gemini API料金** | 約$0.5-0.75 / 800-1,200件（約75-112円） |
| **800-1,200件のコスト** | **約75-112円**（グラウンディング無料） |

### Vertex AI（Gemini 2.0 Flash）

| 項目 | 料金 |
|------|------|
| **グラウンディング料金** | **$14 / 1,000件**（1日1,500件まで無料） |
| **Gemini API料金** | 約$0.1-0.15 / 1,000件 |
| **800-1,200件のコスト** | **約$11.2-16.8**（約**1,680-2,520円**）<br>※無料枠1,500件を超える場合は有料 |

## 推奨：Vertex AI（Gemini 2.5 Pro）に切り替え

### 理由

1. **大幅なコスト削減**
   - Developer API: 約4,200-6,300円
   - Vertex AI（2.5 Pro）: 約75-112円
   - **約98%のコスト削減**

2. **グラウンディング無料枠の活用**
   - 1日10,000件まで無料
   - 800-1,200件は完全に無料枠内

3. **将来の運用も考慮**
   - 日常的な使用でも、1日10,000件までグラウンディング無料
   - 長期的なコスト削減

## 切り替え方法

### ステップ1: Vertex AIの設定

1. Google Cloud Consoleでプロジェクトを作成（または既存プロジェクトを使用）
2. Vertex AI APIを有効化
3. 認証設定:
   ```bash
   gcloud auth application-default login
   gcloud config set project YOUR-PROJECT-ID
   ```

### ステップ2: 環境変数の設定

`.env`ファイルを更新：

```env
# Vertex AIを使用
USE_VERTEX_AI=true
GOOGLE_CLOUD_PROJECT=your-project-id

# Developer APIの設定は削除またはコメントアウト
# GEMINI_API_KEY=...
```

### ステップ3: パッケージのインストール

```bash
npm install @google/genai
```

### ステップ4: スクリプトの実行

```bash
node scripts/verifyDataConsistency.js
```

## 注意事項

### Vertex AIの初期設定が必要

- Google Cloudプロジェクトの作成
- Vertex AI APIの有効化
- 認証設定（gcloud CLIまたはサービスアカウント）

### 料金体系の違い

- **Developer API**: シンプルなAPIキー認証、グラウンディング無料枠なし
- **Vertex AI**: Google Cloud統合、グラウンディング無料枠あり

## まとめ

| 項目 | Developer API | Vertex AI（2.5 Pro） |
|------|---------------|---------------------|
| **初期設定** | 簡単（APIキーのみ） | やや複雑（GCP設定必要） |
| **グラウンディング料金** | $35/1,000件 | 無料（10,000件/日まで） |
| **800-1,200件のコスト** | 約4,200-6,300円 | 約75-112円 |
| **推奨** | ❌ | ✅ **強く推奨** |

**結論**: Vertex AI（Gemini 2.5 Pro）に切り替えることで、**約98%のコスト削減**が可能です。初期設定は必要ですが、長期的に見て大幅なコスト削減になります。
